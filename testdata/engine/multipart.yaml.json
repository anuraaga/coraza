{
  "meta": {
    "author": "airween",
    "description": "Test against multipart payloads",
    "enabled": true,
    "name": "multipart.yaml"
  },
  "rules": "SecRequestBodyAccess On\nSecRule ARGS_POST:_msg_body \"Hi\" \"id:100, phase:2,log\"\nSecRule ARGS_GET:_msg_body \"Hi\" \"id:150, phase:2,log\"\nSecRule REQBODY_ERROR \"!@eq 0\" \\\n  \"id:'200002', phase:2,t:none,log,deny,status:400,msg:'Failed to parse request body.',logdata:'%{reqbody_error_msg}',severity:2\"\n",
  "tests": [
    {
      "stages": [
        {
          "stage": {
            "input": {
              "data": "----0000\nContent-Disposition: form-data; name=\"_msg_body\"\n\nHi Martin,\n\nthis is the test message.\n\nRegards,\n\n--\nairween\n----0000--    \n",
              "headers": {
                "Content-Type": "multipart/form-data; boundary=--0000",
                "Host": "www.example.com"
              },
              "uri": "/test.php?id=12345"
            },
            "output": {
              "non_triggered_rules": [
                150,
                200002
              ],
              "triggered_rules": [
                100
              ]
            }
          }
        }
      ],
      "test_title": "multipart"
    }
  ]
}
