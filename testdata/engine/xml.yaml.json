{
  "meta": {
    "author": "jptosso",
    "description": "Test if the body processors work",
    "enabled": true,
    "name": "postxml.yaml"
  },
  "rules": "SecRequestBodyAccess On\nSecRule REQUEST_HEADERS:content-type \"application/xml\" \"id: 100, phase:1, pass, log, ctl:requestBodyProcessor=XML\"\nSecRule REQBODY_PROCESSOR \"XML\" \"id: 101,phase:2,log,block\"\nSecRule XML:/*|XML://@* \"test123\" \"id:102, phase:2,log,block\"\n#REQUEST_BODY must be empty for XML body processor\nSecRule XML:/* \"test123\" \"id:500, log\"\nSecRule XML://@* \"attribute_value\" \"id:501, log\"",
  "tests": [
    {
      "stages": [
        {
          "stage": {
            "input": {
              "data": "<?xml version=\"1.0\"?><xml><Cs7QAF attribute_name=\"attribute_value\">test123</Cs7QAF></xml>",
              "headers": {
                "content-type": "application/xml"
              },
              "method": "POST",
              "uri": "/index.php?t1=aaa&t2=bbb&t3=ccc"
            },
            "output": {
              "non_triggered_rules": [
                103
              ],
              "triggered_rules": [
                101,
                102,
                500
              ]
            }
          }
        }
      ],
      "test_title": "postxml"
    }
  ],
  "tinygo_disable": true
}
