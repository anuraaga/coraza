{
  "meta": {
    "author": "jptosso",
    "description": "Test if the ctl action works",
    "enabled": true,
    "name": "ctl.yaml"
  },
  "rules": "SecDebugLogLevel 5\nSecRequestBodyAccess On\nSecAction \"id:1, phase:1, ctl:ruleRemoveByTag=test, \\\n    ctl:ruleRemoveById=444, \\\n    ctl:ruleRemoveByMsg=test, \\\n    ctl:ruleRemoveTargetById=5;ARGS:id, \\\n    ctl:ruleRemoveTargetByTag=test-tag;ARGS:id, \\\n    ctl:ruleRemoveTargetByMsg=sometest;ARGS:id, \\\n    ctl:forceRequestBodyVariable=On, \\\n    log\"\nSecAction \"id: 2, phase: 1, log, tag:test\"\nSecAction \"id: 3, phase: 1, log, msg:'test'\"\n\n# this rule should match\nSecRule ARGS \"1234\" \"id: 4, phase: 1, log\"\n# this rule shouldn't match because of the CTL\nSecRule ARGS \"1234\" \"id: 5, phase: 1, log\"\n\n#shouldnt match\nSecRule ARGS \"1234\" \"id: 6, phase: 1, log, tag:test-tag\"\nSecRule ARGS \"1234\" \"id: 7, phase: 1, log, msg:'sometest'\"\n\n# should match\nSecRule REQBODY_PROCESSOR \"URLENCODED\" \"id:100,log,phase:2\"\nSecRule REQUEST_BODY \"pizza\" \"id:103,log,phase:2\"\nSecRule ARGS:pineapple \"pizza\" \"id:105,log,phase:2\"\n\nSecAction \"id:444,phase:2,log\"\n",
  "tests": [
    {
      "stages": [
        {
          "stage": {
            "input": {
              "data": "pineapple=pizza",
              "method": "POST",
              "uri": "/test.php?id=1234"
            },
            "output": {
              "non_triggered_rules": [
                2,
                3,
                5,
                6,
                7,
                444
              ],
              "triggered_rules": [
                1,
                4,
                100,
                103,
                105
              ]
            }
          }
        }
      ],
      "test_title": "actions"
    }
  ]
}
