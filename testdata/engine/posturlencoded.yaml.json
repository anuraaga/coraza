{
  "meta": {
    "author": "jptosso",
    "description": "Test if the body processors work",
    "enabled": true,
    "name": "posturlencoded.yaml"
  },
  "rules": "SecRequestBodyAccess On\nSecRule ARGS:test \"123\" \"phase:2, id:4445,block,log\"\nSecRule REQUEST_BODY \"test=\" \"phase:2, id:456, log\"\n\nSecRule REQBODY_ERROR \"!@eq 0\" \\\n  \"id:'200002', phase:2,t:none,log,deny,status:400,msg:'Failed to parse request body.',logdata:'%{reqbody_error_msg}',severity:2\"\n\nSecRule REQUEST_URI \"case2\" \"id:100, chain, log, phase:2\"\n        SecRule ARGS_NAMES \"SELECT\" \"\"",
  "tests": [
    {
      "stages": [
        {
          "stage": {
            "input": {
              "data": "test=123",
              "headers": {
                "content-type": "application/x-www-form-urlencoded"
              },
              "method": "POST",
              "uri": "/"
            },
            "output": {
              "non_triggered_rules": [
                200002
              ],
              "triggered_rules": [
                4445,
                456
              ]
            }
          }
        },
        {
          "stage": {
            "input": {
              "method": "GET",
              "uri": "/"
            },
            "output": {
              "non_triggered_rules": [
                200002
              ]
            }
          }
        },
        {
          "stage": {
            "input": {
              "data": "var%3d%20@.%3d%20%28%20SELECT",
              "headers": {
                "content-type": "application/x-www-form-urlencoded"
              },
              "method": "POST",
              "uri": "/case2"
            },
            "output": {
              "triggered_rules": [
                100
              ]
            }
          }
        }
      ],
      "test_title": "posturlencoded"
    }
  ]
}
